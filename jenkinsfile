pipeline{
    agent any    
     
    tools { 
        maven "M2_HOME" 
        }
        environment {
    registry = "yasminetlili/devops"
        registryCredential='dockerhub_id'
        dockerImage=''
        }
        
        stages {
            stage('Checkout GIT ') {
                steps {
                    echo 'cheking Git hub Repo ...';
                    git branch : 'yasmine',
                    url : 'https://github.com/nourmanai/achat'
                }
            }
         

         /*   stage('git clone') {
            steps {
               git branch: 'master', 
               url: 'https://github.com/Majdi-msallem/Devops.git'
            }
        }
*/
        

        
          stage('MVN CLEAN INSTALL'){
            steps {
                sh 'mvn clean install -DskipTests=true '

            }
        }

        /*stage('Building our image') { 
            steps { 
                script { 
                    dockerImage = docker.build registry + ":$BUILD_NUMBER" 
                }
            } 
        }



        stage('Deploy our image') { 
            steps { 
                script { 
                    docker.withRegistry( '', registryCredential ) { 
                        dockerImage.push() 
                    }
                } 
            }
        }




        stage('Cleaning up') { 
            steps { 
                sh "docker rmi $registry:$BUILD_NUMBER" 
            }
        }

        
        
        stage ('JUnit / Mockito Test'){
            steps{
                sh 'mvn test'
                }
            }
        

         

stage('show Date') {
            steps {
                echo 'Showing Date...';
                sh """ date """;
            }
        }

     
        

        
         stage('Building our image') { 
            steps { 
                script { 
                    dockerImage = docker.build registry + ":$BUILD_NUMBER" 
                }
            } 
        }
        */
   
       /*
        stage('Cleaning up') { 
            steps { 
                sh "docker rmi $registry:$BUILD_NUMBER" 
            }
        } */

       
}

} 